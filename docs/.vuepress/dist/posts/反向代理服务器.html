<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.14" />
    <style>
      :root {
        --c-bg: #fff;
      }

      html.dark {
        --c-bg: #22272e;
      }

      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <link rel="icon" href="../public/img/logo.png"><title>nginx反向代理服务器 | 天空之城</title><meta name="description" content="理想的城池高悬在天上，地上的河水包围着影子">
    <link rel="stylesheet" href="/assets/css/styles.a5876e6f.css">
    <link rel="preload" href="/assets/js/runtime~app.7a204223.js" as="script"><link rel="preload" href="/assets/css/styles.a5876e6f.css" as="style"><link rel="preload" href="/assets/js/484.0e1141fb.js" as="script"><link rel="preload" href="/assets/js/app.1ea6f656.js" as="script">
    <link rel="prefetch" href="/assets/js/posts_python的简单应用.html.cdc7d315.js" as="script"><link rel="prefetch" href="/assets/js/posts_反向代理服务器.html.502025b7.js" as="script"><link rel="prefetch" href="/assets/js/posts_JDoc.html.f082c4f7.js" as="script"><link rel="prefetch" href="/assets/js/posts_Excel公式.html.8cfe6c3b.js" as="script"><link rel="prefetch" href="/assets/js/161.99140b0f.js" as="script"><link rel="prefetch" href="/iconfont/iconfont.js" as="script"><link rel="prefetch" href="/assets/js/posts_Vue的面试题.html.417d30df.js" as="script"><link rel="prefetch" href="/assets/js/posts_数据库的概念.html.7f4982ee.js" as="script"><link rel="prefetch" href="/assets/js/get-started.html.c205406f.js" as="script"><link rel="prefetch" href="/assets/js/posts_Excel项目实例.html.d7753708.js" as="script"><link rel="prefetch" href="/assets/js/posts_PowerBI实例.html.38ebfabb.js" as="script"><link rel="prefetch" href="/assets/js/index.html.2207da34.js" as="script"><link rel="prefetch" href="/assets/js/category_数据分析_index.html.3edb0a10.js" as="script"><link rel="prefetch" href="/assets/js/category_数据库_index.html.1c9f2b94.js" as="script"><link rel="prefetch" href="/assets/js/category_服务器_index.html.c5e59ead.js" as="script"><link rel="prefetch" href="/assets/js/tag_数据分析_index.html.cce2528d.js" as="script"><link rel="prefetch" href="/assets/js/category_javascript_index.html.9059a318.js" as="script"><link rel="prefetch" href="/assets/js/category_工作_index.html.a3892c74.js" as="script"><link rel="prefetch" href="/assets/js/tag_数据库_index.html.e1f1b23c.js" as="script"><link rel="prefetch" href="/assets/js/tag_服务器_index.html.bc9a2c2c.js" as="script"><link rel="prefetch" href="/assets/js/tag_面试题_index.html.cdd31a20.js" as="script"><link rel="prefetch" href="/iconfont/iconfont.css" as="style"><link rel="prefetch" href="/assets/js/category_python_index.html.4d17ec6e.js" as="script"><link rel="prefetch" href="/assets/js/category_excel_index.html.fceb4ff4.js" as="script"><link rel="prefetch" href="/assets/js/category_vue_index.html.f14011f6.js" as="script"><link rel="prefetch" href="/assets/js/tag_前端_index.html.ac7a65fd.js" as="script"><link rel="prefetch" href="/assets/js/tag_办公_index.html.d26d46e1.js" as="script"><link rel="prefetch" href="/assets/js/tag_工作_index.html.04a6ce5f.js" as="script"><link rel="prefetch" href="/assets/js/tag_技术_index.html.6601c46c.js" as="script"><link rel="prefetch" href="/assets/js/category_bi_index.html.e84e65fc.js" as="script"><link rel="prefetch" href="/assets/js/tag_python_index.html.49d27126.js" as="script"><link rel="prefetch" href="/assets/js/tag_excel_index.html.260c3178.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.4fd82351.js" as="script"><link rel="prefetch" href="/assets/js/tag_vue_index.html.a1f99f10.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.4dce7b8a.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.ac67d607.js" as="script"><link rel="prefetch" href="/assets/js/resume_index.html.38cf3438.js" as="script"><link rel="prefetch" href="/assets/js/404.html.c6f05e9c.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.610a6240.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon"><!--[--><header class="vp-navbar"><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://img2.baidu.com/it/u=3431438589,3113973609&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=340&amp;h=340" alt="天空之城"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">天空之城</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="主页"><!---->主页<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/article/" aria-label="文章"><!---->文章<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="分类"><!---->分类<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="标签"><!---->标签<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="时间表"><!---->时间表<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resume/" aria-label="简历"><!---->简历<!----></a></div><!--]--></nav><!--[--><!--]--><button class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar"><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="主页"><!---->主页<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/article/" aria-label="文章"><!---->文章<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/category/" aria-label="分类"><!---->分类<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tag/" aria-label="标签"><!---->标签<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/timeline/" aria-label="时间表"><!---->时间表<!----></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resume/" aria-label="简历"><!---->简历<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">nginx反向代理服务器 <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="nginx反向代理服务器" tabindex="-1"><a class="header-anchor" href="#nginx反向代理服务器"><span>nginx反向代理服务器</span></a></h1><h2 id="_1-安装nginx服务器" tabindex="-1"><a class="header-anchor" href="#_1-安装nginx服务器"><span>1.安装<code>nginx</code>服务器</span></a></h2><div class="language-cmd line-numbers-mode" data-highlighter="prismjs" data-ext="cmd" data-title="cmd"><pre class="language-cmd"><code><span class="line"> # yum install nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_2-配置nginx的选项" tabindex="-1"><a class="header-anchor" href="#_2-配置nginx的选项"><span>2.配置nginx的选项</span></a></h2><p>​ 找到 <code>/etc/nginx/nginx.conf</code>文件 <a href="......%5CDesktop%5Cfsdownload%5Cnginx.conf">nginx.conf</a></p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre class="language-json"><code><span class="line"># For more information on configuration<span class="token punctuation">,</span> see<span class="token operator">:</span></span>
<span class="line">#   * Official English Documentation<span class="token operator">:</span> http<span class="token operator">:</span><span class="token comment">//nginx.org/en/docs/</span></span>
<span class="line">#   * Official Russian Documentation<span class="token operator">:</span> http<span class="token operator">:</span><span class="token comment">//nginx.org/ru/docs/</span></span>
<span class="line"></span>
<span class="line">user nginx;</span>
<span class="line">worker_processes auto;</span>
<span class="line">error_log /var/log/nginx/error.log;</span>
<span class="line">pid /run/nginx.pid;</span>
<span class="line"></span>
<span class="line"># Load dynamic modules. See /usr/share/doc/nginx/README.dynamic.</span>
<span class="line">include /usr/share/nginx/modules<span class="token comment">/*.conf;</span>
<span class="line"></span>
<span class="line">events {</span>
<span class="line">    worker_connections 1024;</span>
<span class="line">}</span>
<span class="line"></span>
<span class="line">http {</span>
<span class="line">    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span>
<span class="line">                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span>
<span class="line">                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;</span>
<span class="line"></span>
<span class="line">    access_log  /var/log/nginx/access.log  main;</span>
<span class="line"></span>
<span class="line">    sendfile            on;</span>
<span class="line">    tcp_nopush          on;</span>
<span class="line">    tcp_nodelay         on;</span>
<span class="line">    keepalive_timeout   65;</span>
<span class="line">    types_hash_max_size 4096;</span>
<span class="line"></span>
<span class="line">    include             /etc/nginx/mime.types;</span>
<span class="line">    default_type        application/octet-stream;</span>
<span class="line"></span>
<span class="line">    # Load modular configuration files from the /etc/nginx/conf.d directory.</span>
<span class="line">    # See http://nginx.org/en/docs/ngx_core_module.html#include</span>
<span class="line">    # for more information.</span>
<span class="line">    include /etc/nginx/conf.d/*.conf;</span>
<span class="line"></span>
<span class="line">    server {</span>
<span class="line">        listen       80;</span>
<span class="line">        listen       [::]:80;</span>
<span class="line">        server_name  _;</span>
<span class="line">        root         /usr/share/nginx/html;</span>
<span class="line"></span>
<span class="line">        # Load configuration files for the default server block.</span>
<span class="line">        include /etc/nginx/default.d/*.conf;</span>
<span class="line"></span>
<span class="line">        location / {</span>
<span class="line">        	root  /var/www/skycity/dist;</span>
<span class="line">        	index  index.html index.htm;</span>
<span class="line">        	try_files $uri $uri/ /index.html; # 解决刷新404</span>
<span class="line">        }</span>
<span class="line">        </span>
<span class="line">        location /api {</span>
<span class="line">        	proxy_pass http://gmall-h5-api.atguigu.cn;</span>
<span class="line">        }</span>
<span class="line"></span>
<span class="line">        error_page 404 /404.html;</span>
<span class="line">        location = /404.html {</span>
<span class="line">        }</span>
<span class="line"></span>
<span class="line">        error_page 500 502 503 504 /50x.html;</span>
<span class="line">        location = /50x.html {</span>
<span class="line">        }</span>
<span class="line">    }</span>
<span class="line"></span>
<span class="line"># Settings for a TLS enabled server.</span>
<span class="line">#</span>
<span class="line">#    server {</span>
<span class="line">#        listen       443 ssl http2;</span>
<span class="line">#        listen       [::]:443 ssl http2;</span>
<span class="line">#        server_name  _;</span>
<span class="line">#        root         /usr/share/nginx/html;</span>
<span class="line">#</span>
<span class="line">#        ssl_certificate &quot;/etc/pki/nginx/server.crt&quot;;</span>
<span class="line">#        ssl_certificate_key &quot;/etc/pki/nginx/private/server.key&quot;;</span>
<span class="line">#        ssl_session_cache shared:SSL:1m;</span>
<span class="line">#        ssl_session_timeout  10m;</span>
<span class="line">#        ssl_ciphers HIGH:!aNULL:!MD5;</span>
<span class="line">#        ssl_prefer_server_ciphers on;</span>
<span class="line">#</span>
<span class="line">#        # Load configuration files for the default server block.</span>
<span class="line">#        include /etc/nginx/default.d/*.conf;</span>
<span class="line">#</span>
<span class="line">#        error_page 404 /404.html;</span>
<span class="line">#            location = /40x.html {</span>
<span class="line">#        }</span>
<span class="line">#</span>
<span class="line">#        error_page 500 502 503 504 /50x.html;</span>
<span class="line">#            location = /50x.html {</span>
<span class="line">#        }</span>
<span class="line">#    }</span>
<span class="line"></span>
<span class="line">}</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">#配置nginx服务</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line">location / {</span>
<span class="line">        	root   /var/www/app/skycity/dist;</span>
<span class="line">        	index index.html;</span>
<span class="line">        	try_files $uri $uri/ /index.html;</span>
<span class="line">        }</span>
<span class="line">        </span>
<span class="line">        location /api {</span>
<span class="line">        	proxy_pass http://gmall-h5-api.atguigu.cn;</span>
<span class="line">        }</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-启动nginx服务器" tabindex="-1"><a class="header-anchor" href="#_3-启动nginx服务器"><span>3. 启动<code>nginx</code>服务器：</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">service nginx start</span>
<span class="line">// 出现：Redirecting to /bin/systemctl start nginx.service 表示启动成功</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-关闭nginx服务器" tabindex="-1"><a class="header-anchor" href="#_4-关闭nginx服务器"><span>4. 关闭<code>nginx</code>服务器</span></a></h2><p>①：通过系统服务管理器（Systemd）:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">systemctl stop nginx</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>②：如果Nginx没有设置为系统服务，可以直接使用<code>nginx</code>命令:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">nginx -s stop</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>③：如果上述方法都不适用，可以发送信号直接杀死nginx进程（慎用，可能导致数据丢失）:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">kill -quit xxxx</span>
<span class="line">xxxx是进程的编码</span>
<span class="line">pkill -9 nginx</span>
<span class="line">强制杀死 会导致数据丢失</span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-重启nginx服务器" tabindex="-1"><a class="header-anchor" href="#_5-重启nginx服务器"><span>5. 重启nginx服务器</span></a></h2><p>查看当前进程号：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">ps -ef|grep nginx</span>
<span class="line">root     20208  3365  0 23:35 pts/0    00:00:00 grep --color=auto nginx</span>
<span class="line">root     32439     1  0 22:53 ?        00:00:00 nginx: master process /usr/sbin/nginx</span>
<span class="line">nginx    32440 32439  0 22:53 ?        00:00:00 nginx: worker process</span>
<span class="line">nginx    32441 32439  0 22:53 ?        00:00:00 nginx: worker process</span>
<span class="line">324是进程号</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">kill -HUP 20208||进程号</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><!----><!----></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.7a204223.js" defer></script><script src="/assets/js/484.0e1141fb.js" defer></script><script src="/assets/js/app.1ea6f656.js" defer></script>
  </body>
</html>
