"use strict";(self.webpackChunkskycity=self.webpackChunkskycity||[]).push([[229],{2113:(n,s,e)=>{e.r(s),e.d(s,{comp:()=>d,data:()=>c});var a=e(641);const i=[(0,a.Fv)('<h1 id="nginx反向代理服务器" tabindex="-1"><a class="header-anchor" href="#nginx反向代理服务器"><span>nginx反向代理服务器</span></a></h1><h2 id="_1-安装nginx服务器" tabindex="-1"><a class="header-anchor" href="#_1-安装nginx服务器"><span>1.安装<code>nginx</code>服务器</span></a></h2><div class="language-cmd line-numbers-mode" data-highlighter="prismjs" data-ext="cmd" data-title="cmd"><pre class="language-cmd"><code><span class="line"> # yum install nginx</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_2-配置nginx的选项" tabindex="-1"><a class="header-anchor" href="#_2-配置nginx的选项"><span>2.配置nginx的选项</span></a></h2><p>​ 找到 <code>/etc/nginx/nginx.conf</code>文件 <a href="......%5CDesktop%5Cfsdownload%5Cnginx.conf">nginx.conf</a></p><div class="language-json line-numbers-mode" data-highlighter="prismjs" data-ext="json" data-title="json"><pre class="language-json"><code><span class="line"># For more information on configuration<span class="token punctuation">,</span> see<span class="token operator">:</span></span>\n<span class="line">#   * Official English Documentation<span class="token operator">:</span> http<span class="token operator">:</span><span class="token comment">//nginx.org/en/docs/</span></span>\n<span class="line">#   * Official Russian Documentation<span class="token operator">:</span> http<span class="token operator">:</span><span class="token comment">//nginx.org/ru/docs/</span></span>\n<span class="line"></span>\n<span class="line">user nginx;</span>\n<span class="line">worker_processes auto;</span>\n<span class="line">error_log /var/log/nginx/error.log;</span>\n<span class="line">pid /run/nginx.pid;</span>\n<span class="line"></span>\n<span class="line"># Load dynamic modules. See /usr/share/doc/nginx/README.dynamic.</span>\n<span class="line">include /usr/share/nginx/modules<span class="token comment">/*.conf;</span>\n<span class="line"></span>\n<span class="line">events {</span>\n<span class="line">    worker_connections 1024;</span>\n<span class="line">}</span>\n<span class="line"></span>\n<span class="line">http {</span>\n<span class="line">    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#39;</span>\n<span class="line">                      &#39;$status $body_bytes_sent &quot;$http_referer&quot; &#39;</span>\n<span class="line">                      &#39;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#39;;</span>\n<span class="line"></span>\n<span class="line">    access_log  /var/log/nginx/access.log  main;</span>\n<span class="line"></span>\n<span class="line">    sendfile            on;</span>\n<span class="line">    tcp_nopush          on;</span>\n<span class="line">    tcp_nodelay         on;</span>\n<span class="line">    keepalive_timeout   65;</span>\n<span class="line">    types_hash_max_size 4096;</span>\n<span class="line"></span>\n<span class="line">    include             /etc/nginx/mime.types;</span>\n<span class="line">    default_type        application/octet-stream;</span>\n<span class="line"></span>\n<span class="line">    # Load modular configuration files from the /etc/nginx/conf.d directory.</span>\n<span class="line">    # See http://nginx.org/en/docs/ngx_core_module.html#include</span>\n<span class="line">    # for more information.</span>\n<span class="line">    include /etc/nginx/conf.d/*.conf;</span>\n<span class="line"></span>\n<span class="line">    server {</span>\n<span class="line">        listen       80;</span>\n<span class="line">        listen       [::]:80;</span>\n<span class="line">        server_name  _;</span>\n<span class="line">        root         /usr/share/nginx/html;</span>\n<span class="line"></span>\n<span class="line">        # Load configuration files for the default server block.</span>\n<span class="line">        include /etc/nginx/default.d/*.conf;</span>\n<span class="line"></span>\n<span class="line">        location / {</span>\n<span class="line">        \troot  /var/www/skycity/dist;</span>\n<span class="line">        \tindex  index.html index.htm;</span>\n<span class="line">        \ttry_files $uri $uri/ /index.html; # 解决刷新404</span>\n<span class="line">        }</span>\n<span class="line">        </span>\n<span class="line">        location /api {</span>\n<span class="line">        \tproxy_pass http://gmall-h5-api.atguigu.cn;</span>\n<span class="line">        }</span>\n<span class="line"></span>\n<span class="line">        error_page 404 /404.html;</span>\n<span class="line">        location = /404.html {</span>\n<span class="line">        }</span>\n<span class="line"></span>\n<span class="line">        error_page 500 502 503 504 /50x.html;</span>\n<span class="line">        location = /50x.html {</span>\n<span class="line">        }</span>\n<span class="line">    }</span>\n<span class="line"></span>\n<span class="line"># Settings for a TLS enabled server.</span>\n<span class="line">#</span>\n<span class="line">#    server {</span>\n<span class="line">#        listen       443 ssl http2;</span>\n<span class="line">#        listen       [::]:443 ssl http2;</span>\n<span class="line">#        server_name  _;</span>\n<span class="line">#        root         /usr/share/nginx/html;</span>\n<span class="line">#</span>\n<span class="line">#        ssl_certificate &quot;/etc/pki/nginx/server.crt&quot;;</span>\n<span class="line">#        ssl_certificate_key &quot;/etc/pki/nginx/private/server.key&quot;;</span>\n<span class="line">#        ssl_session_cache shared:SSL:1m;</span>\n<span class="line">#        ssl_session_timeout  10m;</span>\n<span class="line">#        ssl_ciphers HIGH:!aNULL:!MD5;</span>\n<span class="line">#        ssl_prefer_server_ciphers on;</span>\n<span class="line">#</span>\n<span class="line">#        # Load configuration files for the default server block.</span>\n<span class="line">#        include /etc/nginx/default.d/*.conf;</span>\n<span class="line">#</span>\n<span class="line">#        error_page 404 /404.html;</span>\n<span class="line">#            location = /40x.html {</span>\n<span class="line">#        }</span>\n<span class="line">#</span>\n<span class="line">#        error_page 500 502 503 504 /50x.html;</span>\n<span class="line">#            location = /50x.html {</span>\n<span class="line">#        }</span>\n<span class="line">#    }</span>\n<span class="line"></span>\n<span class="line">}</span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">#配置nginx服务</span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">location / {</span>\n<span class="line">        \troot   /var/www/app/skycity/dist;</span>\n<span class="line">        \tindex index.html;</span>\n<span class="line">        \ttry_files $uri $uri/ /index.html;</span>\n<span class="line">        }</span>\n<span class="line">        </span>\n<span class="line">        location /api {</span>\n<span class="line">        \tproxy_pass http://gmall-h5-api.atguigu.cn;</span>\n<span class="line">        }</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-启动nginx服务器" tabindex="-1"><a class="header-anchor" href="#_3-启动nginx服务器"><span>3. 启动<code>nginx</code>服务器：</span></a></h2><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">service nginx start</span>\n<span class="line">// 出现：Redirecting to /bin/systemctl start nginx.service 表示启动成功</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-关闭nginx服务器" tabindex="-1"><a class="header-anchor" href="#_4-关闭nginx服务器"><span>4. 关闭<code>nginx</code>服务器</span></a></h2><p>①：通过系统服务管理器（Systemd）:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">systemctl stop nginx</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>②：如果Nginx没有设置为系统服务，可以直接使用<code>nginx</code>命令:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">nginx -s stop</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>③：如果上述方法都不适用，可以发送信号直接杀死nginx进程（慎用，可能导致数据丢失）:</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">kill -quit xxxx</span>\n<span class="line">xxxx是进程的编码</span>\n<span class="line">pkill -9 nginx</span>\n<span class="line">强制杀死 会导致数据丢失</span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-重启nginx服务器" tabindex="-1"><a class="header-anchor" href="#_5-重启nginx服务器"><span>5. 重启nginx服务器</span></a></h2><p>查看当前进程号：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">ps -ef|grep nginx</span>\n<span class="line">root     20208  3365  0 23:35 pts/0    00:00:00 grep --color=auto nginx</span>\n<span class="line">root     32439     1  0 22:53 ?        00:00:00 nginx: master process /usr/sbin/nginx</span>\n<span class="line">nginx    32440 32439  0 22:53 ?        00:00:00 nginx: worker process</span>\n<span class="line">nginx    32441 32439  0 22:53 ?        00:00:00 nginx: worker process</span>\n<span class="line">324是进程号</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre class="language-text"><code><span class="line">kill -HUP 20208||进程号</span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div>',20)],l={},d=(0,e(6262).A)(l,[["render",function(n,s){return(0,a.uX)(),(0,a.CE)("div",null,i)}]]),c=JSON.parse('{"path":"/posts/%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8.html","title":"nginx反向代理服务器","lang":"en-US","frontmatter":{"date":"2024-03-06T00:00:00.000Z","category":["服务器"],"tag":["技术","服务器"],"archive":false},"headers":[{"level":2,"title":"1.安装nginx服务器","slug":"_1-安装nginx服务器","link":"#_1-安装nginx服务器","children":[]},{"level":2,"title":"2.配置nginx的选项","slug":"_2-配置nginx的选项","link":"#_2-配置nginx的选项","children":[]},{"level":2,"title":"3. 启动nginx服务器：","slug":"_3-启动nginx服务器","link":"#_3-启动nginx服务器","children":[]},{"level":2,"title":"4. 关闭nginx服务器","slug":"_4-关闭nginx服务器","link":"#_4-关闭nginx服务器","children":[]},{"level":2,"title":"5. 重启nginx服务器","slug":"_5-重启nginx服务器","link":"#_5-重启nginx服务器","children":[]}],"git":{"updatedTime":1720629500000,"contributors":[{"name":"huchenghepang","email":"2927678784@qq.com","commits":1}]},"filePathRelative":"posts/反向代理服务器.md","excerpt":"\\n<h2>1.安装<code>nginx</code>服务器</h2>\\n<div class=\\"language-cmd\\" data-highlighter=\\"prismjs\\" data-ext=\\"cmd\\" data-title=\\"cmd\\"><pre class=\\"language-cmd\\"><code><span class=\\"line\\"> # yum install nginx</span>\\n<span class=\\"line\\"></span></code></pre></div><h2>2.配置nginx的选项</h2>\\n<p>​\\t找到 <code>/etc/nginx/nginx.conf</code>文件 <a href=\\"......%5CDesktop%5Cfsdownload%5Cnginx.conf\\">nginx.conf</a></p>"}')}}]);