"use strict";(self.webpackChunkskycity=self.webpackChunkskycity||[]).push([[283],{3228:(n,s,a)=>{a.r(s),a.d(s,{comp:()=>e,data:()=>c});var p=a(641);const t=[(0,p.Fv)('<h1 id="python-办公项目实例" tabindex="-1"><a class="header-anchor" href="#python-办公项目实例"><span>python 办公项目实例</span></a></h1><ol><li><h2 id="python实现的群发工资条" tabindex="-1"><a class="header-anchor" href="#python实现的群发工资条"><span>python实现的群发工资条</span></a></h2></li></ol><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd</span>\n<span class="line"><span class="token keyword">import</span> imgkit</span>\n<span class="line"><span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>multipart <span class="token keyword">import</span> MIMEMultipart</span>\n<span class="line"><span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>text <span class="token keyword">import</span> MIMEText</span>\n<span class="line"><span class="token keyword">import</span> smtplib</span>\n<span class="line"><span class="token keyword">from</span> email<span class="token punctuation">.</span>mime<span class="token punctuation">.</span>image <span class="token keyword">import</span> MIMEImage</span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">def</span> <span class="token function">send_salary_slip</span><span class="token punctuation">(</span>sender_email<span class="token punctuation">,</span> sender_password<span class="token punctuation">,</span> receiver_email<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    <span class="token comment"># 创建邮件内容对象</span></span>\n<span class="line">    msg <span class="token operator">=</span> MIMEMultipart<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line">    msg<span class="token punctuation">[</span><span class="token string">&#39;From&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> sender_email</span>\n<span class="line">    msg<span class="token punctuation">[</span><span class="token string">&#39;To&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> receiver_email</span>\n<span class="line">    msg<span class="token punctuation">[</span><span class="token string">&#39;Subject&#39;</span><span class="token punctuation">]</span> <span class="token operator">=</span> subject</span>\n<span class="line">    <span class="token comment">#  将HTML转为图片</span></span>\n<span class="line">    config <span class="token operator">=</span> imgkit<span class="token punctuation">.</span>config<span class="token punctuation">(</span>wkhtmltoimage<span class="token operator">=</span> <span class="token string">r&quot;D:\\program files\\wkhtmltopdf\\bin\\wkhtmltoimage.exe&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    imgkit<span class="token punctuation">.</span>from_string<span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">&#39;./output.png&#39;</span><span class="token punctuation">,</span>config<span class="token operator">=</span>config<span class="token punctuation">)</span></span>\n<span class="line">    <span class="token comment"># 添加图片附件</span></span>\n<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">&#39;output.png&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span></span>\n<span class="line">        image_part <span class="token operator">=</span> MIMEImage<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">        image_part<span class="token punctuation">.</span>add_header<span class="token punctuation">(</span><span class="token string">&#39;Content-Disposition&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;attachment&#39;</span><span class="token punctuation">,</span> filename<span class="token operator">=</span><span class="token string">&#39;output.png&#39;</span><span class="token punctuation">)</span></span>\n<span class="line">        msg<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>image_part<span class="token punctuation">)</span></span>\n<span class="line">    <span class="token comment"># 添加邮件正文</span></span>\n<span class="line">    msg<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>MIMEText<span class="token punctuation">(</span>message<span class="token punctuation">,</span> <span class="token string">&#39;html&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">    <span class="token comment"># 连接到SMTP服务器</span></span>\n<span class="line">    server <span class="token operator">=</span> smtplib<span class="token punctuation">.</span>SMTP<span class="token punctuation">(</span><span class="token string">&#39;smtp.qq.com&#39;</span><span class="token punctuation">)</span>  <span class="token comment"># 这里使用的是Gmail的SMTP服务器，如果使用其他邮箱，请查阅相应的SMTP服务器地址和端口号</span></span>\n<span class="line">    server<span class="token punctuation">.</span>starttls<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">try</span><span class="token punctuation">:</span></span>\n<span class="line">        <span class="token comment"># 登录邮箱</span></span>\n<span class="line">        server<span class="token punctuation">.</span>login<span class="token punctuation">(</span>sender_email<span class="token punctuation">,</span> sender_password<span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">        <span class="token comment"># 发送邮件</span></span>\n<span class="line">        server<span class="token punctuation">.</span>sendmail<span class="token punctuation">(</span>sender_email<span class="token punctuation">,</span> receiver_email<span class="token punctuation">,</span> msg<span class="token punctuation">.</span>as_string<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;邮件发送成功&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>\n<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;邮件发送失败:&quot;</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token keyword">finally</span><span class="token punctuation">:</span></span>\n<span class="line">        <span class="token comment"># 关闭连接</span></span>\n<span class="line">        server<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">def</span> <span class="token function">generate_salary_slip</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    <span class="token comment"># 批量进行变量命名</span></span>\n<span class="line">    variable_prefix <span class="token operator">=</span> <span class="token string">&quot;variable_&quot;</span>  <span class="token comment"># 变量名前缀</span></span>\n<span class="line">    variable_count <span class="token operator">=</span> <span class="token number">48</span>  <span class="token comment"># 变量数量</span></span>\n<span class="line">    <span class="token comment"># 使用循环生成变量名</span></span>\n<span class="line">    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> variable_count <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">        variable_name <span class="token operator">=</span> variable_prefix<span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span></span>\n<span class="line">        <span class="token comment"># 在这里可以使用生成的变量名进行后续操作</span></span>\n<span class="line">        <span class="token comment"># 例如，可以使用 exec() 函数动态创建变量</span></span>\n<span class="line">        <span class="token keyword">exec</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_name<span class="token punctuation">}</span></span><span class="token string"> = row[</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">]&quot;</span></span><span class="token punctuation">,</span><span class="token builtin">globals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">    <span class="token comment"># 生成HTML内容</span></span>\n<span class="line">    html <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;&quot;&quot;</span>\n<span class="line">            &lt;body&gt;</span>\n<span class="line">    &lt;table border=&quot;1&quot; style=&quot;border-collapse: collapse;&quot;&gt;</span>\n<span class="line">        &lt;caption&gt;员工工资表&lt;/caption&gt;</span>\n<span class="line">        &lt;tr align=&quot;center&quot; valign=&quot;middle&quot;&gt;</span>\n<span class="line">            &lt;td rowspan=&quot;2&quot;&gt;姓名&lt;/td&gt;</span>\n<span class="line">            &lt;td rowspan=&quot;2&quot;&gt;任职&lt;/td&gt;</span>\n<span class="line">            &lt;td colspan=&quot;7&quot;&gt;基本数据&lt;/td&gt;</span>\n<span class="line">            &lt;td colspan=&quot;2&quot;&gt;出勤天数&lt;/td&gt;</span>\n<span class="line">            &lt;td colspan=&quot;22&quot;&gt;应发栏&lt;/td&gt;</span>\n<span class="line">            &lt;td colspan=&quot;14&quot;&gt;代扣栏&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;实发栏&lt;/td&gt;</span>\n<span class="line">        &lt;/tr&gt;</span>\n<span class="line">        &lt;tr&gt;</span>\n<span class="line">            &lt;td&gt;岗位工资&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;季度绩效薪系数&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;月掘进奖岗位系数&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;年功工资&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;职务津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;专业技术津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;公立天数&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;出勤&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;其他&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;岗位工资&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;年功工资&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;出勤工资&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;月度掘进奖&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;职位津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;专业技术津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;注册执业津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;流动施工津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;技术测量实验津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;隧道施工津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;高原地区津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;风沙地区津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;伙食补贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;社保补助津贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;公务通讯补助&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;防暑降温补贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;采暖费补贴&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;女卫费&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;季度绩效薪&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;法定节假日加班工资&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;其他工资&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;合计&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;企业年金&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;养老保险&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;失业保险&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;住房公积金&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;医疗保险&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;其他扣款&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;专项附加扣除&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;年累应纳税所得额&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;年累应缴个税&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;年累已缴个税&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;本月个税&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;伙食费&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;风险抵押金&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;合计&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;实发合计&lt;/td&gt;</span>\n<span class="line">        &lt;/tr&gt;</span>\n<span class="line">        &lt;tr&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_1<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_2<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_3<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_4<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_5<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_6<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_7<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_8<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_9<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_10<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_11<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_12<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_13<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_14<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_15<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_16<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_17<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_18<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_19<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_20<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_21<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_22<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_23<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_24<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_25<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_26<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_27<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_28<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_29<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_30<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_31<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_32<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_33<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_34<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_35<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_36<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_37<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_38<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_39<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_40<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_41<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_42<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_43<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_44<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_45<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_46<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_47<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">            &lt;td&gt;</span><span class="token interpolation"><span class="token punctuation">{</span>variable_48<span class="token punctuation">}</span></span><span class="token string">&lt;/td&gt;</span>\n<span class="line">        &lt;/tr&gt;</span>\n<span class="line">    &lt;/table&gt;</span>\n<span class="line">&lt;/body&gt;</span>\n<span class="line">    &quot;&quot;&quot;</span></span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">return</span> html</span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 读取工资条数据</span></span>\n<span class="line">df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span><span class="token string">&#39;./工资条.xlsx&#39;</span><span class="token punctuation">,</span>sheet_name<span class="token operator">=</span><span class="token string">&quot;Sheet1&quot;</span><span class="token punctuation">)</span>  <span class="token comment"># 将&#39;salary_data.xlsx&#39;替换为您的工资条数据文件路径</span></span>\n<span class="line">df <span class="token operator">=</span> df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">&#39;&#39;</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 邮箱信息</span></span>\n<span class="line">sender_email <span class="token operator">=</span> <span class="token string">&#39;2927678784@qq.com&#39;</span>  <span class="token comment"># 发件人邮箱</span></span>\n<span class="line">sender_password <span class="token operator">=</span> <span class="token string">&#39;dpbnrtofkhmqdgcb&#39;</span>  <span class="token comment"># 发件人邮箱密码或授权码</span></span>\n<span class="line"><span class="token comment"># subject = &#39;工资数据&#39;  # 邮件主题</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 遍历每位员工的工资信息，生成HTML工资条并发送邮件</span></span>\n<span class="line"><span class="token keyword">for</span> index<span class="token punctuation">,</span> row <span class="token keyword">in</span> df<span class="token punctuation">.</span>iterrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    receiver_email <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token string">&#39;邮箱账号&#39;</span><span class="token punctuation">]</span>  <span class="token comment"># 假设邮箱账号列名为&#39;邮箱账号&#39;，请根据实际情况修改</span></span>\n<span class="line">    subject <span class="token operator">=</span> <span class="token string">&#39;工资条&#39;</span>  <span class="token comment"># 邮件主题</span></span>\n<span class="line">    message <span class="token operator">=</span> generate_salary_slip<span class="token punctuation">(</span>row<span class="token punctuation">)</span>  <span class="token comment"># 生成HTML工资条内容的函数，根据实际情况修改</span></span>\n<span class="line">    send_salary_slip<span class="token punctuation">(</span>sender_email<span class="token punctuation">,</span> sender_password<span class="token punctuation">,</span> receiver_email<span class="token punctuation">,</span> subject<span class="token punctuation">,</span> message<span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-python实现的pdf页面分割" tabindex="-1"><a class="header-anchor" href="#_2-python实现的pdf页面分割"><span>2. python实现的PDF页面分割</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> PyPDF4</span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 打开包含多个页面的pdf文件，并将每页分隔成自上而下的三等分页面</span></span>\n<span class="line"><span class="token keyword">def</span> <span class="token function">pdf_divide</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> output<span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">,</span> <span class="token string">&#39;rb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span></span>\n<span class="line">        reader <span class="token operator">=</span> PyPDF4<span class="token punctuation">.</span>PdfFileReader<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span></span>\n<span class="line">        <span class="token comment"># 获取总页数</span></span>\n<span class="line">        total_pages <span class="token operator">=</span> reader<span class="token punctuation">.</span>getNumPages<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line">        <span class="token comment"># 创建一个新的pdf writer</span></span>\n<span class="line">        writer <span class="token operator">=</span> PyPDF4<span class="token punctuation">.</span>PdfFileWriter<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">        <span class="token comment"># 对每一页执行以下步骤</span></span>\n<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>total_pages<span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">            <span class="token comment"># 获取当前页的对象</span></span>\n<span class="line">            page <span class="token operator">=</span> reader<span class="token punctuation">.</span>getPage<span class="token punctuation">(</span>i<span class="token punctuation">)</span></span>\n<span class="line">            <span class="token comment"># 获取当前页的大小</span></span>\n<span class="line">            page_width <span class="token operator">=</span> page<span class="token punctuation">.</span>mediaBox<span class="token punctuation">.</span>getWidth<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line">            page_height <span class="token operator">=</span> page<span class="token punctuation">.</span>mediaBox<span class="token punctuation">.</span>getHeight<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">            <span class="token comment"># 将当前页的内容分割成自上而下的三等分页面</span></span>\n<span class="line">            part_height <span class="token operator">=</span> page_height <span class="token operator">/</span> <span class="token number">3</span></span>\n<span class="line"></span>\n<span class="line">            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">                <span class="token comment"># 计算每个部分的坐标</span></span>\n<span class="line">                y1 <span class="token operator">=</span> page_height <span class="token operator">-</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> part_height</span>\n<span class="line">                y2 <span class="token operator">=</span> page_height <span class="token operator">-</span> j <span class="token operator">*</span> part_height</span>\n<span class="line"></span>\n<span class="line">                <span class="token comment"># 创建一个新的pdf页面</span></span>\n<span class="line">                new_page <span class="token operator">=</span> PyPDF4<span class="token punctuation">.</span>pdf<span class="token punctuation">.</span>PageObject<span class="token punctuation">.</span>createBlankPage<span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> page_width<span class="token punctuation">,</span> part_height<span class="token punctuation">)</span></span>\n<span class="line">                <span class="token comment"># 将当前部分的内容复制到新页中</span></span>\n<span class="line">                new_page<span class="token punctuation">.</span>mergeTranslatedPage<span class="token punctuation">(</span>page<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span>y1<span class="token punctuation">)</span></span>\n<span class="line">                <span class="token comment"># 将新页面添加到写入器中</span></span>\n<span class="line">                writer<span class="token punctuation">.</span>addPage<span class="token punctuation">(</span>new_page<span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">        <span class="token comment"># 将所有的页面写入一个新的pdf文件</span></span>\n<span class="line">        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>output<span class="token punctuation">,</span> <span class="token string">&#39;wb&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> output_file<span class="token punctuation">:</span></span>\n<span class="line">            writer<span class="token punctuation">.</span>write<span class="token punctuation">(</span>output_file<span class="token punctuation">)</span></span>\n<span class="line">pdf_divide<span class="token punctuation">(</span><span class="token string">&quot;print_template.pdf&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;0963账户-4月回单-拆分.pdf&quot;</span><span class="token punctuation">)</span></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-python-实现的银行联行号爬取" tabindex="-1"><a class="header-anchor" href="#_3-python-实现的银行联行号爬取"><span>3.python 实现的银行联行号爬取</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> requests</span>\n<span class="line"><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup</span>\n<span class="line"></span>\n<span class="line">url <span class="token operator">=</span> <span class="token string">&quot;https://www.lianhanghao.com/api/bank/lhhTableData&quot;</span></span>\n<span class="line"></span>\n<span class="line">headers <span class="token operator">=</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token string">&#39;User-Agent&#39;</span><span class="token punctuation">:</span> <span class="token string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36 Edg/120.0.0.0&quot;</span><span class="token punctuation">,</span></span>\n<span class="line"><span class="token string">&#39;Cookie&#39;</span><span class="token punctuation">:</span><span class="token string">&#39;Hm_lvt_1383965d855ebd4bf00569c1849b2ecb=1703774814; Hm_lpvt_1383965d855ebd4bf00569c1849b2ecb=1703775751; __gads=ID=053be257abbe808a:T=1703774828:RT=1703775751:S=ALNI_MYG_lwA6mE-_4KQDGLo4AclQ75P0g; __gpi=UID=00000cc8a78dc1eb:T=1703774828:RT=1703775751:S=ALNI_Ma0WZrdgw0Ayh0OpcMzhXgT0h2Zwg&#39;</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"></span>\n<span class="line">response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span></span>\n<span class="line">data <span class="token operator">=</span> <span class="token punctuation">{</span></span>\n<span class="line">    <span class="token string">&quot;current&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&quot;size&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;20&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;bank_id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;province_id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;city_id&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;keywords&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span></span>\n<span class="line"><span class="token punctuation">}</span></span>\n<span class="line"><span class="token keyword">if</span> response<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span></span>\n<span class="line">    xhr_content <span class="token operator">=</span> response<span class="token punctuation">.</span>text</span>\n<span class="line">    <span class="token comment"># soup = BeautifulSoup(xhr_content, &quot;html.parser&quot;)</span></span>\n<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span>xhr_content<span class="token punctuation">)</span></span>\n<span class="line"><span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;爬取失败&quot;</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-python爬虫-东方财富网上市公司资产负债表数据" tabindex="-1"><a class="header-anchor" href="#_4-python爬虫-东方财富网上市公司资产负债表数据"><span>4. python爬虫 东方财富网上市公司资产负债表数据</span></a></h2><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre class="language-python"><code><span class="line"><span class="token keyword">import</span> requests</span>\n<span class="line"><span class="token keyword">import</span> re</span>\n<span class="line"><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup</span>\n<span class="line"><span class="token keyword">from</span> openpyxl <span class="token keyword">import</span> Workbook</span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">import</span> openpyxl</span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">class</span> <span class="token class-name">CXlAutofit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    <span class="token comment"># 生成列名字典，只是为了方便修改列宽时指定列，key:数字，从1开始；value:列名，从A开始</span></span>\n<span class="line">    <span class="token keyword">def</span> <span class="token function">get_num_colnum_dict</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">        <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>\n<span class="line">        :return: 返回字典：{1:&#39;A&#39;, 2:&#39;B&#39;, ...... , 52:&#39;AZ&#39;}</span>\n<span class="line">        &#39;&#39;&#39;</span></span>\n<span class="line">        num_str_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>\n<span class="line">        A_Z <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">&#39;Z&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>\n<span class="line">        AA_AZ <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;A&#39;</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">&#39;A&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">&#39;Z&#39;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>\n<span class="line">        A_AZ <span class="token operator">=</span> A_Z <span class="token operator">+</span> AA_AZ</span>\n<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> A_AZ<span class="token punctuation">:</span></span>\n<span class="line">            num_str_dict<span class="token punctuation">[</span>A_AZ<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> i</span>\n<span class="line">        <span class="token keyword">return</span> num_str_dict</span>\n<span class="line"></span>\n<span class="line">    <span class="token comment"># 自适应列宽</span></span>\n<span class="line">    <span class="token keyword">def</span> <span class="token function">style_excel</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> excel_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">,</span> sheet_name<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">        <span class="token triple-quoted-string string">&#39;&#39;&#39;</span>\n<span class="line">        :param sheet_name:  excel中的sheet名</span>\n<span class="line">        :return:</span>\n<span class="line">        &#39;&#39;&#39;</span></span>\n<span class="line">        <span class="token comment"># 打开excel</span></span>\n<span class="line">        wb <span class="token operator">=</span> openpyxl<span class="token punctuation">.</span>load_workbook<span class="token punctuation">(</span>excel_name<span class="token punctuation">)</span></span>\n<span class="line">        <span class="token comment"># 选择对应的sheet</span></span>\n<span class="line">        sheet <span class="token operator">=</span> wb<span class="token punctuation">[</span>sheet_name<span class="token punctuation">]</span></span>\n<span class="line">        <span class="token comment"># 获取最大行数与最大列数</span></span>\n<span class="line">        max_column <span class="token operator">=</span> sheet<span class="token punctuation">.</span>max_column</span>\n<span class="line">        max_row <span class="token operator">=</span> sheet<span class="token punctuation">.</span>max_row</span>\n<span class="line"></span>\n<span class="line">        <span class="token comment"># 将每一列，单元格列宽最大的列宽值存到字典里，key:列的序号从1开始(与字典num_str_dic中的key对应)；value:列宽的值</span></span>\n<span class="line">        max_column_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>\n<span class="line"></span>\n<span class="line">        <span class="token comment"># 生成列名字典，只是为了方便修改列宽时指定列，key:数字，从1开始；value:列名，从A开始</span></span>\n<span class="line">        num_str_dict <span class="token operator">=</span> self<span class="token punctuation">.</span>get_num_colnum_dict<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">        <span class="token comment"># 遍历全部列</span></span>\n<span class="line">        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> max_column <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">            <span class="token comment"># 遍历每一列的全部行</span></span>\n<span class="line">            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> max_row <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">                column <span class="token operator">=</span> <span class="token number">0</span></span>\n<span class="line">                <span class="token comment"># 获取j行i列的值</span></span>\n<span class="line">                sheet_value <span class="token operator">=</span> sheet<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>j<span class="token punctuation">,</span> column<span class="token operator">=</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>value</span>\n<span class="line">                <span class="token comment"># 通过列表生成式生成字符列表，将当前获取到的单元格的str值的每一个字符放在一个列表中（列表中一个元素是一个字符）</span></span>\n<span class="line">                sheet_value_list <span class="token operator">=</span> <span class="token punctuation">[</span>k <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>sheet_value<span class="token punctuation">)</span><span class="token punctuation">]</span></span>\n<span class="line">                <span class="token comment"># 遍历当前单元格的字符列表</span></span>\n<span class="line">                <span class="token keyword">for</span> v <span class="token keyword">in</span> sheet_value_list<span class="token punctuation">:</span></span>\n<span class="line">                    <span class="token comment"># 判定长度，一个数字或一个字母，单元格列宽+=1.1，其它+=2.2（长度可根据需要自行修改，经测试一个字母的列宽长度大概为1）</span></span>\n<span class="line">                    <span class="token keyword">if</span> v<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span> <span class="token keyword">or</span> v<span class="token punctuation">.</span>isalpha<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">:</span></span>\n<span class="line">                        column <span class="token operator">+=</span> <span class="token number">1.1</span></span>\n<span class="line">                    <span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">                        column <span class="token operator">+=</span> <span class="token number">2.2</span></span>\n<span class="line">                <span class="token comment"># 当前单元格列宽与字典中的对比，大于字典中的列宽值则将字典更新。如果字典没有这个key，抛出异常并将值添加到字典中</span></span>\n<span class="line">                <span class="token keyword">try</span><span class="token punctuation">:</span></span>\n<span class="line">                    <span class="token keyword">if</span> column <span class="token operator">&gt;</span> max_column_dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span></span>\n<span class="line">                        max_column_dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> column</span>\n<span class="line">                <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></span>\n<span class="line">                    max_column_dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> column</span>\n<span class="line">        <span class="token comment"># 此时max_column_dict字典中已存有当前sheet的所有列的最大列宽值，直接遍历字典修改列宽</span></span>\n<span class="line">        <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> max_column_dict<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">            sheet<span class="token punctuation">.</span>column_dimensions<span class="token punctuation">[</span>num_str_dict<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">.</span>width <span class="token operator">=</span> value</span>\n<span class="line">        <span class="token comment"># 保存</span></span>\n<span class="line">        wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>excel_name<span class="token punctuation">)</span></span>\n<span class="line">china_zfczb<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;流动负债&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;流动资产&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;非流动资产&quot;</span><span class="token punctuation">,</span><span class="token string">&#39;非流动负债&#39;</span><span class="token punctuation">,</span><span class="token string">&#39;所有者权益(或股东权益)&#39;</span><span class="token punctuation">]</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 使用requests库获得文本</span></span>\n<span class="line">stock_code <span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">&quot;请输入要查询的股票代码:数字即可\\n请输入:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"><span class="token triple-quoted-string string">&quot;&quot;&quot;选择报告的时间段&quot;&quot;&quot;</span></span>\n<span class="line"><span class="token comment"># 按年度计算</span></span>\n<span class="line">time <span class="token operator">=</span> <span class="token number">2021</span></span>\n<span class="line"><span class="token comment"># 按报告期计算</span></span>\n<span class="line">year <span class="token operator">=</span> <span class="token number">2021</span>     <span class="token comment">#要查询的年份报告期</span></span>\n<span class="line">month <span class="token operator">=</span> <span class="token number">6</span>     <span class="token comment">#要查询最近报告期月份</span></span>\n<span class="line">month_day<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;31&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;6&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;30&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;9&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;30&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;12&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;31&quot;</span><span class="token punctuation">}</span></span>\n<span class="line">i <span class="token operator">=</span> <span class="token number">0</span></span>\n<span class="line">month_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>\n<span class="line">year_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>\n<span class="line">month_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>month<span class="token punctuation">)</span></span>\n<span class="line">year_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">while</span> i<span class="token operator">&lt;</span><span class="token number">4</span><span class="token punctuation">:</span></span>\n<span class="line"></span>\n<span class="line">    month<span class="token operator">=</span>month<span class="token operator">-</span><span class="token number">3</span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">if</span> month <span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span></span>\n<span class="line">        month <span class="token operator">=</span> <span class="token number">12</span></span>\n<span class="line">        year <span class="token operator">=</span> year<span class="token operator">-</span><span class="token number">1</span></span>\n<span class="line"></span>\n<span class="line">    year_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line">    month_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>month<span class="token punctuation">)</span></span>\n<span class="line">    i <span class="token operator">+=</span> <span class="token number">1</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># print(month_day[str(month_list[0])])</span></span>\n<span class="line"></span>\n<span class="line">stock_plate <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;sz&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;SZ&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;sh&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;SH&quot;</span><span class="token punctuation">]</span></span>\n<span class="line"><span class="token triple-quoted-string string">&quot;&quot;&quot;判断其板块&quot;&quot;&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">if</span> stock_code<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&quot;6&quot;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    stock_demo <span class="token operator">=</span> <span class="token string">&quot;sh&quot;</span><span class="token operator">+</span>stock_code</span>\n<span class="line">    stock_demo1 <span class="token operator">=</span> <span class="token string">&quot;SH&quot;</span><span class="token operator">+</span>stock_code</span>\n<span class="line"><span class="token keyword">elif</span> stock_code<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    stock_demo <span class="token operator">=</span> <span class="token string">&quot;sz&quot;</span> <span class="token operator">+</span> stock_code</span>\n<span class="line">    stock_demo1 <span class="token operator">=</span> <span class="token string">&quot;SZ&quot;</span> <span class="token operator">+</span> stock_code</span>\n<span class="line"><span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;无法判断股票代码:&quot;</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;http://emweb.eastmoney.com/PC_HSF10/NewFinanceAnalysis/Index?type=web&amp;code=</span><span class="token interpolation"><span class="token punctuation">{</span>stock_demo<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span></span>\n<span class="line">resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token triple-quoted-string string">&quot;&quot;&quot;用beautifulsoup提取信息：股票名称，&quot;&quot;&quot;</span></span>\n<span class="line">soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">,</span><span class="token string">&quot;html.parser&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">title_list<span class="token operator">=</span> soup<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token string">&quot;title&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">&quot;(&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">title<span class="token operator">=</span>title_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>\n<span class="line"><span class="token comment"># print(title_list)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token triple-quoted-string string">&quot;&quot;&quot;用re库正则表达式取得信息&quot;&quot;&quot;</span></span>\n<span class="line"><span class="token comment"># 用re库正则提取资产负债表的脚本代码内容</span></span>\n<span class="line">zcfzb_model <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r&#39;&lt;script type=&quot;text/template&quot; id=&quot;zcfzb_qy&quot;&gt;.*?&lt;/script&gt;&#39;</span></span>\n<span class="line">                         <span class="token punctuation">,</span>re<span class="token punctuation">.</span>S<span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment"># 提取tbody标签内容</span></span>\n<span class="line">zcfzb_mode0 <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r&#39;(&lt;tbody&gt;\\s+&lt;tr&gt;\\s+&lt;th class=&quot;tips-colname-Left&quot; style=&quot;width: 366px;&quot;&gt;.*?&lt;/tbody&gt;)&#39;</span></span>\n<span class="line">                         <span class="token punctuation">,</span>re<span class="token punctuation">.</span>S<span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment">#提取name和数据代码</span></span>\n<span class="line">name_model <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r&#39;\\s+([\\u4e00-\\u9fa5].*?)\\s+&#39;</span><span class="token punctuation">,</span>re<span class="token punctuation">.</span>S<span class="token punctuation">)</span></span>\n<span class="line">name1_model <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r&#39;\\s+(其中:\\w*?)\\s+&#39;</span><span class="token punctuation">,</span>re<span class="token punctuation">.</span>S<span class="token punctuation">)</span></span>\n<span class="line">date_model <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r&quot;\\{\\{format\\w*?\\(value.(?P&lt;date&gt;\\w*?)\\)}}&quot;</span><span class="token punctuation">,</span>re<span class="token punctuation">.</span>S<span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment">#使用re提取</span></span>\n<span class="line">zcf <span class="token operator">=</span>zcfzb_model<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>resp<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>\n<span class="line">zcfzb <span class="token operator">=</span><span class="token string">&#39;&#39;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>zcf<span class="token punctuation">)</span></span>\n<span class="line">zcf1 <span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>zcfzb_mode0<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>zcfzb<span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># print(zcf1)</span></span>\n<span class="line"><span class="token comment"># print(zcfzb)</span></span>\n<span class="line"><span class="token comment">#beautifulsoup库提取</span></span>\n<span class="line">soup <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>zcf1<span class="token punctuation">,</span><span class="token string">&quot;html.parser&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">trs <span class="token operator">=</span> soup<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span><span class="token string">&quot;tr&quot;</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment">#创建一个列表，用于储存字典</span></span>\n<span class="line">lis <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span>\n<span class="line"><span class="token comment"># print(len(trs))</span></span>\n<span class="line"><span class="token keyword">for</span> tr <span class="token keyword">in</span> trs<span class="token punctuation">:</span></span>\n<span class="line">    <span class="token comment"># 注意字典的添加会有相似代替</span></span>\n<span class="line">    dic <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>\n<span class="line">    <span class="token comment"># print(tr.text)</span></span>\n<span class="line">    names<span class="token operator">=</span>name_model<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>tr<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>\n<span class="line">    names1<span class="token operator">=</span>name1_model<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>tr<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>\n<span class="line">    date <span class="token operator">=</span>date_model<span class="token punctuation">.</span>findall<span class="token punctuation">(</span>tr<span class="token punctuation">.</span>text<span class="token punctuation">)</span></span>\n<span class="line">    <span class="token comment"># print(names,names1)</span></span>\n<span class="line">    <span class="token keyword">if</span> names1<span class="token punctuation">:</span></span>\n<span class="line">        <span class="token comment"># print(names1)</span></span>\n<span class="line">        name_str <span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>names1<span class="token punctuation">)</span></span>\n<span class="line">        dic<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span>name_str</span>\n<span class="line">    <span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">        <span class="token comment"># print(names)</span></span>\n<span class="line">        name_str <span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>names<span class="token punctuation">)</span></span>\n<span class="line">        dic<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> name_str</span>\n<span class="line">    date_str<span class="token operator">=</span><span class="token string">&quot;&quot;</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>date<span class="token punctuation">)</span></span>\n<span class="line">    dic<span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span><span class="token operator">=</span>date_str</span>\n<span class="line">    <span class="token comment"># print(dic)</span></span>\n<span class="line">    <span class="token comment"># print(date)</span></span>\n<span class="line">    lis<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dic<span class="token punctuation">)</span></span>\n<span class="line">    <span class="token comment"># print(&quot;--------&quot;)</span></span>\n<span class="line">lis<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;REPORT_DATE&quot;</span></span>\n<span class="line"><span class="token comment"># print(lis)</span></span>\n<span class="line"><span class="token comment"># print(len(lis))</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">url1 <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;http://emweb.eastmoney.com/PC_HSF10/NewFinanceAnalysis/zcfzbAjaxNew?companyType=4&amp;reportDateType=1&amp;reportType=1&amp;dates=</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token punctuation">}</span></span><span class="token string">-12-31%2C</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token string">-12-31%2C</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">}</span></span><span class="token string">-12-31%2C</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">}</span></span><span class="token string">-12-31%2C</span><span class="token interpolation"><span class="token punctuation">{</span>time<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">}</span></span><span class="token string">-12-31&amp;code=</span><span class="token interpolation"><span class="token punctuation">{</span>stock_demo1<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span></span>\n<span class="line">url2 <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f&quot;http://emweb.eastmoney.com/PC_HSF10/NewFinanceAnalysis/zcfzbAjaxNew?companyType=4&amp;reportDateType=0&amp;reportType=1&amp;dates=</span><span class="token interpolation"><span class="token punctuation">{</span>year_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_day<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>month_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">%2C</span><span class="token interpolation"><span class="token punctuation">{</span>year_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_day<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>month_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">%2C</span><span class="token interpolation"><span class="token punctuation">{</span>year_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_day<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>month_list<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">%2C</span><span class="token interpolation"><span class="token punctuation">{</span>year_list<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_list<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_day<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>month_list<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">%2C</span><span class="token interpolation"><span class="token punctuation">{</span>year_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token punctuation">{</span>month_day<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>month_list<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&amp;code=</span><span class="token interpolation"><span class="token punctuation">{</span>stock_demo1<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span></span>\n<span class="line"></span>\n<span class="line">resp1 <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url1<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">40</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># print(resp1.text)</span></span>\n<span class="line">resp_json<span class="token operator">=</span>resp1<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment"># print(resp_json)</span></span>\n<span class="line">date_list <span class="token operator">=</span>resp_json<span class="token punctuation">[</span><span class="token string">&quot;data&quot;</span><span class="token punctuation">]</span></span>\n<span class="line">count <span class="token operator">=</span> resp_json<span class="token punctuation">[</span><span class="token string">&quot;count&quot;</span><span class="token punctuation">]</span></span>\n<span class="line"><span class="token comment"># print(count)</span></span>\n<span class="line"><span class="token keyword">for</span> i <span class="token keyword">in</span> date_list<span class="token punctuation">:</span></span>\n<span class="line">    <span class="token comment"># 获得遍历列表的元素序号,col是字符串</span></span>\n<span class="line">    col <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>date_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">    <span class="token keyword">for</span> n <span class="token keyword">in</span> lis<span class="token punctuation">:</span></span>\n<span class="line">        <span class="token comment"># 获得当前得到的是哪个字典的数据</span></span>\n<span class="line">        <span class="token comment"># print(n)</span></span>\n<span class="line">        index <span class="token operator">=</span>lis<span class="token punctuation">.</span>index<span class="token punctuation">(</span>n<span class="token punctuation">)</span></span>\n<span class="line">        date <span class="token operator">=</span> n<span class="token punctuation">[</span><span class="token string">&quot;date&quot;</span><span class="token punctuation">]</span></span>\n<span class="line">        <span class="token keyword">try</span><span class="token punctuation">:</span></span>\n<span class="line">            info <span class="token operator">=</span> i<span class="token punctuation">[</span>date<span class="token punctuation">]</span></span>\n<span class="line">            <span class="token comment"># print(info)</span></span>\n<span class="line">            <span class="token comment"># print(type(info))</span></span>\n<span class="line">            lis<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> info</span>\n<span class="line">            <span class="token comment"># print(&quot;一个项目的数据完成了\\n&quot;)</span></span>\n<span class="line"></span>\n<span class="line"></span>\n<span class="line">        <span class="token keyword">except</span><span class="token punctuation">:</span></span>\n<span class="line">            <span class="token keyword">if</span> n<span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">&quot;吸收存款及同业存放&quot;</span><span class="token punctuation">:</span></span>\n<span class="line">              info <span class="token operator">=</span> <span class="token string">&quot;&quot;</span></span>\n<span class="line">              lis<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> info</span>\n<span class="line">            <span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">                info <span class="token operator">=</span> <span class="token string">&quot;--&quot;</span></span>\n<span class="line">                <span class="token comment"># print(info)</span></span>\n<span class="line">                <span class="token comment"># print(type(info))</span></span>\n<span class="line">                lis<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token operator">=</span> info</span>\n<span class="line">                <span class="token comment"># print(&quot;一个项目的数据完成了---\\n&quot;)</span></span>\n<span class="line">        <span class="token comment"># print(&quot;一年的数据成功的完成了\\n&quot;)</span></span>\n<span class="line"><span class="token comment"># print(lis)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token triple-quoted-string string">&quot;&quot;&quot;创建一个Excel工作簿，为xlsx格式&quot;&quot;&quot;</span></span>\n<span class="line">wb <span class="token operator">=</span> Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment"># 新建一个工作表并命名，</span></span>\n<span class="line">ws <span class="token operator">=</span> wb<span class="token punctuation">.</span>active</span>\n<span class="line">ws<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&quot;资产负债表1&quot;</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 计算表的行数和列数</span></span>\n<span class="line">rows <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lis<span class="token punctuation">)</span></span>\n<span class="line">cols <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>lis<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">for</span> a <span class="token keyword">in</span> lis<span class="token punctuation">:</span></span>\n<span class="line">    row_n <span class="token operator">=</span> lis<span class="token punctuation">.</span>index<span class="token punctuation">(</span>a<span class="token punctuation">)</span></span>\n<span class="line">    <span class="token comment"># print(row_n)</span></span>\n<span class="line">    col<span class="token operator">=</span> <span class="token number">0</span></span>\n<span class="line">    <span class="token keyword">for</span> v <span class="token keyword">in</span> a<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">        <span class="token keyword">if</span> col<span class="token operator">&lt;</span>cols<span class="token punctuation">:</span></span>\n<span class="line">            ws<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row_n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>col<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>v<span class="token punctuation">)</span></span>\n<span class="line">            col <span class="token operator">+=</span> <span class="token number">1</span></span>\n<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;出错&quot;</span><span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment"># 删除不要的数据，以便美化图表</span></span>\n<span class="line">ws<span class="token punctuation">.</span>delete_cols<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token comment">#删除数据data列</span></span>\n<span class="line">max_row<span class="token operator">=</span>ws<span class="token punctuation">.</span>max_row</span>\n<span class="line">max_col <span class="token operator">=</span> ws<span class="token punctuation">.</span>max_column</span>\n<span class="line">col_list <span class="token operator">=</span> <span class="token punctuation">[</span>j <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_col<span class="token punctuation">)</span><span class="token punctuation">]</span></span>\n<span class="line"><span class="token comment"># print(max_row,man_col)</span></span>\n<span class="line">shanchu <span class="token operator">=</span><span class="token punctuation">[</span> <span class="token punctuation">]</span></span>\n<span class="line"><span class="token keyword">for</span> r <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_row<span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">    <span class="token comment"># 数量限制判断</span></span>\n<span class="line">    x <span class="token operator">=</span> <span class="token number">0</span></span>\n<span class="line">    <span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>max_col<span class="token punctuation">)</span><span class="token punctuation">:</span></span>\n<span class="line">        <span class="token keyword">if</span> ws<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>row<span class="token operator">=</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> column<span class="token operator">=</span>c<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">]</span><span class="token punctuation">:</span></span>\n<span class="line">            x <span class="token operator">+=</span> <span class="token number">1</span></span>\n<span class="line">            <span class="token comment"># print(&quot;x&quot;,x)</span></span>\n<span class="line">            <span class="token keyword">if</span> x <span class="token operator">&gt;</span><span class="token number">4</span><span class="token punctuation">:</span></span>\n<span class="line">                <span class="token comment">#记录要删除的行</span></span>\n<span class="line">                shanchu<span class="token punctuation">.</span>append<span class="token punctuation">(</span>r<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span></span>\n<span class="line">            <span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">                <span class="token keyword">continue</span></span>\n<span class="line">        <span class="token keyword">else</span><span class="token punctuation">:</span></span>\n<span class="line">            <span class="token keyword">continue</span></span>\n<span class="line"><span class="token comment"># print(shanchu)</span></span>\n<span class="line"><span class="token comment"># print(len(shanchu))</span></span>\n<span class="line">ws1 <span class="token operator">=</span> wb<span class="token punctuation">.</span>create_sheet<span class="token punctuation">(</span><span class="token string">&quot;资产负债表&quot;</span><span class="token punctuation">)</span></span>\n<span class="line">dat <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>lis<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span></span>\n<span class="line"></span>\n<span class="line"><span class="token keyword">for</span> c <span class="token keyword">in</span> shanchu<span class="token punctuation">:</span></span>\n<span class="line">    dat<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>c<span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment"># print(dat)</span></span>\n<span class="line"><span class="token keyword">for</span> z <span class="token keyword">in</span> dat<span class="token punctuation">:</span></span>\n<span class="line">    q<span class="token operator">=</span>dat<span class="token punctuation">.</span>index<span class="token punctuation">(</span>z<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span></span>\n<span class="line">    <span class="token keyword">for</span> c <span class="token keyword">in</span> col_list<span class="token punctuation">:</span></span>\n<span class="line">        r <span class="token operator">=</span> col_list<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span></span>\n<span class="line">        ws1<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>q<span class="token punctuation">,</span>r<span class="token punctuation">,</span>ws<span class="token punctuation">.</span>cell<span class="token punctuation">(</span>z<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line">wb<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>ws<span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment"># row_number = 0</span></span>\n<span class="line"><span class="token comment"># for row in ws.iter_rows():#迭代遍历每行</span></span>\n<span class="line"><span class="token comment">#     if cols[2,6] is None:   #给定的条件，读者可根据自身需求自定义</span></span>\n<span class="line"><span class="token comment">#         row_number=col[2:6].row #关键步骤！获得当前行的行号！</span></span>\n<span class="line"><span class="token comment">#         print(row_number)</span></span>\n<span class="line"><span class="token comment">#         ws.delete_rows(row_number)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># lis1=[v for a in lis for v in a.values()]</span></span>\n<span class="line"><span class="token comment"># print(lis1)</span></span>\n<span class="line">bname<span class="token operator">=</span><span class="token string-interpolation"><span class="token string">f&quot;./</span><span class="token interpolation"><span class="token punctuation">{</span>title<span class="token punctuation">}</span></span><span class="token string">.xlsx&quot;</span></span></span>\n<span class="line">wb<span class="token punctuation">.</span>save<span class="token punctuation">(</span>bname<span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"><span class="token comment"># 调用方法 实例化类</span></span>\n<span class="line">Entity <span class="token operator">=</span> CXlAutofit<span class="token punctuation">(</span><span class="token punctuation">)</span></span>\n<span class="line"><span class="token comment"># 传入参数：Excel名称，需要设置列宽的Sheet名称</span></span>\n<span class="line">Entity<span class="token punctuation">.</span>style_excel<span class="token punctuation">(</span>bname<span class="token punctuation">,</span> <span class="token string">&quot;资产负债表&quot;</span><span class="token punctuation">)</span></span>\n<span class="line"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;保存成功&#39;</span><span class="token punctuation">)</span></span>\n<span class="line"></span>\n<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>',9)],l={},e=(0,a(6262).A)(l,[["render",function(n,s){return(0,p.uX)(),(0,p.CE)("div",null,t)}]]),c=JSON.parse('{"path":"/posts/python%E7%9A%84%E7%AE%80%E5%8D%95%E5%BA%94%E7%94%A8.html","title":"python 办公项目实例","lang":"en-US","frontmatter":{"date":"2024-07-10T00:00:00.000Z","category":["python"],"tag":["python"],"archive":false},"headers":[{"level":2,"title":"2. python实现的PDF页面分割","slug":"_2-python实现的pdf页面分割","link":"#_2-python实现的pdf页面分割","children":[]},{"level":2,"title":"3.python 实现的银行联行号爬取","slug":"_3-python-实现的银行联行号爬取","link":"#_3-python-实现的银行联行号爬取","children":[]},{"level":2,"title":"4. python爬虫 东方财富网上市公司资产负债表数据","slug":"_4-python爬虫-东方财富网上市公司资产负债表数据","link":"#_4-python爬虫-东方财富网上市公司资产负债表数据","children":[]}],"git":{},"filePathRelative":"posts/python的简单应用.md","excerpt":"\\n<ol>\\n<li>\\n<h2>python实现的群发工资条</h2>\\n</li>\\n</ol>\\n<div class=\\"language-python\\" data-highlighter=\\"prismjs\\" data-ext=\\"py\\" data-title=\\"py\\"><pre class=\\"language-python\\"><code><span class=\\"line\\"><span class=\\"token keyword\\">import</span> pandas <span class=\\"token keyword\\">as</span> pd</span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">import</span> imgkit</span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">from</span> email<span class=\\"token punctuation\\">.</span>mime<span class=\\"token punctuation\\">.</span>multipart <span class=\\"token keyword\\">import</span> MIMEMultipart</span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">from</span> email<span class=\\"token punctuation\\">.</span>mime<span class=\\"token punctuation\\">.</span>text <span class=\\"token keyword\\">import</span> MIMEText</span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">import</span> smtplib</span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">from</span> email<span class=\\"token punctuation\\">.</span>mime<span class=\\"token punctuation\\">.</span>image <span class=\\"token keyword\\">import</span> MIMEImage</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">def</span> <span class=\\"token function\\">send_salary_slip</span><span class=\\"token punctuation\\">(</span>sender_email<span class=\\"token punctuation\\">,</span> sender_password<span class=\\"token punctuation\\">,</span> receiver_email<span class=\\"token punctuation\\">,</span> subject<span class=\\"token punctuation\\">,</span> message<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">    <span class=\\"token comment\\"># 创建邮件内容对象</span></span>\\n<span class=\\"line\\">    msg <span class=\\"token operator\\">=</span> MIMEMultipart<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">    msg<span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\'From\'</span><span class=\\"token punctuation\\">]</span> <span class=\\"token operator\\">=</span> sender_email</span>\\n<span class=\\"line\\">    msg<span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\'To\'</span><span class=\\"token punctuation\\">]</span> <span class=\\"token operator\\">=</span> receiver_email</span>\\n<span class=\\"line\\">    msg<span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\'Subject\'</span><span class=\\"token punctuation\\">]</span> <span class=\\"token operator\\">=</span> subject</span>\\n<span class=\\"line\\">    <span class=\\"token comment\\">#  将HTML转为图片</span></span>\\n<span class=\\"line\\">    config <span class=\\"token operator\\">=</span> imgkit<span class=\\"token punctuation\\">.</span>config<span class=\\"token punctuation\\">(</span>wkhtmltoimage<span class=\\"token operator\\">=</span> <span class=\\"token string\\">r\\"D:\\\\program files\\\\wkhtmltopdf\\\\bin\\\\wkhtmltoimage.exe\\"</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">    imgkit<span class=\\"token punctuation\\">.</span>from_string<span class=\\"token punctuation\\">(</span>message<span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\'./output.png\'</span><span class=\\"token punctuation\\">,</span>config<span class=\\"token operator\\">=</span>config<span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">    <span class=\\"token comment\\"># 添加图片附件</span></span>\\n<span class=\\"line\\">    <span class=\\"token keyword\\">with</span> <span class=\\"token builtin\\">open</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'output.png\'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\'rb\'</span><span class=\\"token punctuation\\">)</span> <span class=\\"token keyword\\">as</span> f<span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">        image_part <span class=\\"token operator\\">=</span> MIMEImage<span class=\\"token punctuation\\">(</span>f<span class=\\"token punctuation\\">.</span>read<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">        image_part<span class=\\"token punctuation\\">.</span>add_header<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'Content-Disposition\'</span><span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\'attachment\'</span><span class=\\"token punctuation\\">,</span> filename<span class=\\"token operator\\">=</span><span class=\\"token string\\">\'output.png\'</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">        msg<span class=\\"token punctuation\\">.</span>attach<span class=\\"token punctuation\\">(</span>image_part<span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">    <span class=\\"token comment\\"># 添加邮件正文</span></span>\\n<span class=\\"line\\">    msg<span class=\\"token punctuation\\">.</span>attach<span class=\\"token punctuation\\">(</span>MIMEText<span class=\\"token punctuation\\">(</span>message<span class=\\"token punctuation\\">,</span> <span class=\\"token string\\">\'html\'</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">    <span class=\\"token comment\\"># 连接到SMTP服务器</span></span>\\n<span class=\\"line\\">    server <span class=\\"token operator\\">=</span> smtplib<span class=\\"token punctuation\\">.</span>SMTP<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'smtp.qq.com\'</span><span class=\\"token punctuation\\">)</span>  <span class=\\"token comment\\"># 这里使用的是Gmail的SMTP服务器，如果使用其他邮箱，请查阅相应的SMTP服务器地址和端口号</span></span>\\n<span class=\\"line\\">    server<span class=\\"token punctuation\\">.</span>starttls<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">    <span class=\\"token keyword\\">try</span><span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">        <span class=\\"token comment\\"># 登录邮箱</span></span>\\n<span class=\\"line\\">        server<span class=\\"token punctuation\\">.</span>login<span class=\\"token punctuation\\">(</span>sender_email<span class=\\"token punctuation\\">,</span> sender_password<span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">        <span class=\\"token comment\\"># 发送邮件</span></span>\\n<span class=\\"line\\">        server<span class=\\"token punctuation\\">.</span>sendmail<span class=\\"token punctuation\\">(</span>sender_email<span class=\\"token punctuation\\">,</span> receiver_email<span class=\\"token punctuation\\">,</span> msg<span class=\\"token punctuation\\">.</span>as_string<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">        <span class=\\"token keyword\\">print</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"邮件发送成功\\"</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">    <span class=\\"token keyword\\">except</span> Exception <span class=\\"token keyword\\">as</span> e<span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">        <span class=\\"token keyword\\">print</span><span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\\"邮件发送失败:\\"</span><span class=\\"token punctuation\\">,</span> <span class=\\"token builtin\\">str</span><span class=\\"token punctuation\\">(</span>e<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">    <span class=\\"token keyword\\">finally</span><span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">        <span class=\\"token comment\\"># 关闭连接</span></span>\\n<span class=\\"line\\">        server<span class=\\"token punctuation\\">.</span>quit<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">def</span> <span class=\\"token function\\">generate_salary_slip</span><span class=\\"token punctuation\\">(</span>row<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">    <span class=\\"token comment\\"># 批量进行变量命名</span></span>\\n<span class=\\"line\\">    variable_prefix <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\\"variable_\\"</span>  <span class=\\"token comment\\"># 变量名前缀</span></span>\\n<span class=\\"line\\">    variable_count <span class=\\"token operator\\">=</span> <span class=\\"token number\\">48</span>  <span class=\\"token comment\\"># 变量数量</span></span>\\n<span class=\\"line\\">    <span class=\\"token comment\\"># 使用循环生成变量名</span></span>\\n<span class=\\"line\\">    <span class=\\"token keyword\\">for</span> i <span class=\\"token keyword\\">in</span> <span class=\\"token builtin\\">range</span><span class=\\"token punctuation\\">(</span><span class=\\"token number\\">1</span><span class=\\"token punctuation\\">,</span> variable_count <span class=\\"token operator\\">+</span> <span class=\\"token number\\">1</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">        variable_name <span class=\\"token operator\\">=</span> variable_prefix<span class=\\"token operator\\">+</span> <span class=\\"token builtin\\">str</span><span class=\\"token punctuation\\">(</span>i<span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">        <span class=\\"token comment\\"># 在这里可以使用生成的变量名进行后续操作</span></span>\\n<span class=\\"line\\">        <span class=\\"token comment\\"># 例如，可以使用 exec() 函数动态创建变量</span></span>\\n<span class=\\"line\\">        <span class=\\"token keyword\\">exec</span><span class=\\"token punctuation\\">(</span><span class=\\"token string-interpolation\\"><span class=\\"token string\\">f\\"</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_name<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\"> = row[</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>i<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">]\\"</span></span><span class=\\"token punctuation\\">,</span><span class=\\"token builtin\\">globals</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\">    <span class=\\"token comment\\"># 生成HTML内容</span></span>\\n<span class=\\"line\\">    html <span class=\\"token operator\\">=</span> <span class=\\"token string-interpolation\\"><span class=\\"token string\\">f\\"\\"\\"</span>\\n<span class=\\"line\\">            &lt;body&gt;</span>\\n<span class=\\"line\\">    &lt;table border=\\"1\\" style=\\"border-collapse: collapse;\\"&gt;</span>\\n<span class=\\"line\\">        &lt;caption&gt;员工工资表&lt;/caption&gt;</span>\\n<span class=\\"line\\">        &lt;tr align=\\"center\\" valign=\\"middle\\"&gt;</span>\\n<span class=\\"line\\">            &lt;td rowspan=\\"2\\"&gt;姓名&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td rowspan=\\"2\\"&gt;任职&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td colspan=\\"7\\"&gt;基本数据&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td colspan=\\"2\\"&gt;出勤天数&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td colspan=\\"22\\"&gt;应发栏&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td colspan=\\"14\\"&gt;代扣栏&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;实发栏&lt;/td&gt;</span>\\n<span class=\\"line\\">        &lt;/tr&gt;</span>\\n<span class=\\"line\\">        &lt;tr&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;岗位工资&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;季度绩效薪系数&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;月掘进奖岗位系数&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;年功工资&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;职务津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;专业技术津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;公立天数&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;出勤&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;其他&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;岗位工资&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;年功工资&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;出勤工资&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;月度掘进奖&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;职位津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;专业技术津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;注册执业津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;流动施工津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;技术测量实验津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;隧道施工津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;高原地区津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;风沙地区津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;伙食补贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;社保补助津贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;公务通讯补助&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;防暑降温补贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;采暖费补贴&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;女卫费&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;季度绩效薪&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;法定节假日加班工资&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;其他工资&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;合计&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;企业年金&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;养老保险&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;失业保险&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;住房公积金&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;医疗保险&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;其他扣款&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;专项附加扣除&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;年累应纳税所得额&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;年累应缴个税&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;年累已缴个税&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;本月个税&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;伙食费&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;风险抵押金&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;合计&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;实发合计&lt;/td&gt;</span>\\n<span class=\\"line\\">        &lt;/tr&gt;</span>\\n<span class=\\"line\\">        &lt;tr&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_1<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_2<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_3<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_4<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_5<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_6<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_7<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_8<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_9<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_10<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_11<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_12<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_13<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_14<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_15<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_16<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_17<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_18<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_19<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_20<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_21<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_22<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_23<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_24<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_25<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_26<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_27<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_28<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_29<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_30<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_31<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_32<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_33<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_34<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_35<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_36<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_37<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_38<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_39<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_40<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_41<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_42<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_43<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_44<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_45<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_46<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_47<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">            &lt;td&gt;</span><span class=\\"token interpolation\\"><span class=\\"token punctuation\\">{</span>variable_48<span class=\\"token punctuation\\">}</span></span><span class=\\"token string\\">&lt;/td&gt;</span>\\n<span class=\\"line\\">        &lt;/tr&gt;</span>\\n<span class=\\"line\\">    &lt;/table&gt;</span>\\n<span class=\\"line\\">&lt;/body&gt;</span>\\n<span class=\\"line\\">    \\"\\"\\"</span></span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\">    <span class=\\"token keyword\\">return</span> html</span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token comment\\"># 读取工资条数据</span></span>\\n<span class=\\"line\\">df <span class=\\"token operator\\">=</span> pd<span class=\\"token punctuation\\">.</span>read_excel<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'./工资条.xlsx\'</span><span class=\\"token punctuation\\">,</span>sheet_name<span class=\\"token operator\\">=</span><span class=\\"token string\\">\\"Sheet1\\"</span><span class=\\"token punctuation\\">)</span>  <span class=\\"token comment\\"># 将\'salary_data.xlsx\'替换为您的工资条数据文件路径</span></span>\\n<span class=\\"line\\">df <span class=\\"token operator\\">=</span> df<span class=\\"token punctuation\\">.</span>fillna<span class=\\"token punctuation\\">(</span><span class=\\"token string\\">\'\'</span><span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token comment\\"># 邮箱信息</span></span>\\n<span class=\\"line\\">sender_email <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\'2927678784@qq.com\'</span>  <span class=\\"token comment\\"># 发件人邮箱</span></span>\\n<span class=\\"line\\">sender_password <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\'dpbnrtofkhmqdgcb\'</span>  <span class=\\"token comment\\"># 发件人邮箱密码或授权码</span></span>\\n<span class=\\"line\\"><span class=\\"token comment\\"># subject = \'工资数据\'  # 邮件主题</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span class=\\"token comment\\"># 遍历每位员工的工资信息，生成HTML工资条并发送邮件</span></span>\\n<span class=\\"line\\"><span class=\\"token keyword\\">for</span> index<span class=\\"token punctuation\\">,</span> row <span class=\\"token keyword\\">in</span> df<span class=\\"token punctuation\\">.</span>iterrows<span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">:</span></span>\\n<span class=\\"line\\">    receiver_email <span class=\\"token operator\\">=</span> row<span class=\\"token punctuation\\">[</span><span class=\\"token string\\">\'邮箱账号\'</span><span class=\\"token punctuation\\">]</span>  <span class=\\"token comment\\"># 假设邮箱账号列名为\'邮箱账号\'，请根据实际情况修改</span></span>\\n<span class=\\"line\\">    subject <span class=\\"token operator\\">=</span> <span class=\\"token string\\">\'工资条\'</span>  <span class=\\"token comment\\"># 邮件主题</span></span>\\n<span class=\\"line\\">    message <span class=\\"token operator\\">=</span> generate_salary_slip<span class=\\"token punctuation\\">(</span>row<span class=\\"token punctuation\\">)</span>  <span class=\\"token comment\\"># 生成HTML工资条内容的函数，根据实际情况修改</span></span>\\n<span class=\\"line\\">    send_salary_slip<span class=\\"token punctuation\\">(</span>sender_email<span class=\\"token punctuation\\">,</span> sender_password<span class=\\"token punctuation\\">,</span> receiver_email<span class=\\"token punctuation\\">,</span> subject<span class=\\"token punctuation\\">,</span> message<span class=\\"token punctuation\\">)</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"></span></code></pre></div>"}')}}]);