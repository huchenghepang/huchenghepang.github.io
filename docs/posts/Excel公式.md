---
date: 2024-01-08
category:
  - 工作
tag:
  - Excel
  - 工作
  - 办公
archive: false
---
# Excel公式




1.提取单据编号：

```
=IFERROR(MID(R5,FIND(":",R5,1)+1,FIND("。",R5,1)-FIND(":",R5,1)-1),"")
```

2.字符串替换公式：

```
=substitute(origin_string,old_string,newstring)
=substitute(,,)
```

3.对账单模板公式：

```html
//处理原信息得到唯一值
=CONCAT("NO:",COUNTIF($C$3:$C3,C3),"_",C3)
//统计本表的唯一项在另一表是否存在
=IF(COUNTIF(企业银行存款余额表,E3)=1,"收付款无误","有误待查")
```

CONCAT("NO:",(COUNTIF($L$3:$L206,L206)-COUNTIF($L$3:$L206,-L206))

4.工资贴公式

```
=XLOOKUP(C3,'[1.银行卡信息表-汇总-汇总.xlsx]工资卡信息'!$A$2:$A$200,'[1.银行卡信息表-汇总-汇总.xlsx]工资卡信息'!$B$2:$B$200)
=XLOOKUP(B1,'C:\Users\Administrator\Desktop\employee_compensation\[1.银行卡信息表-汇总-汇总.xlsx]工资卡信息'!$A$2:$A$200,'C:\Users\Administrator\Desktop\employee_compensation\[1.银行卡信息表-汇总-汇总.xlsx]工资卡信息'!$B$2:$B$200)
```

5.查找某个单元格的行号

```
=MAX(('[2、2023年正式员工考勤表（现场施工人员）.xlsx]2023（8月份) '!$B$6:$B$30=B5)*ROW($6:$30))
```

6.工资导入模板

```
=VLOOKUP($B2,[工资模板姓名去重和合并查询.xlsx]新模板!$A$2:$P$72,COLUMN()-1,FALSE)
=ROUNDDOWN(VLOOKUP($B2,[工资模板姓名去重和合并查询.xlsx]新模板!$A$2:$P$72,COLUMN()-1,FALSE),0)
=ROUNDDown(VLOOKUP($B2,[工资模板姓名去重和合并查询.xlsx]新模板!$A$2:$P$72,COLUMN()-1,FALSE),0)
```

7.清除数据快捷键

```
    Range("A3:B999").Select
    Selection.ClearContents
```

8.通讯补助

```
=ROUND(IFS(D20>18,200,D20>=11,400,D20<=10,600)*SUM(L20:M20)/K20,0)
```

9.绩效薪资标准：

```
=IFS(D6>=23,200,D6>=20,500,D6>=18,1800,D6>=15,2700,D6>=13,3100,D6<=12,3300)
```

10.个税申报系列公式

正常薪金所得表

11.工号匹配：

```
=XLOOKUP($B2,[境内人员信息列表.xls]Sheet1!$B$2:$B$400,[境内人员信息列表.xls]Sheet1!$A$2:$A$400,"")
```

12.证件号码：

```
=XLOOKUP($B2,[境内人员信息列表.xls]Sheet1!$B$2:$B$400,[境内人员信息列表.xls]Sheet1!$D$2:$D$400,"")
```

13.本期收入：

```
=XLOOKUP($B2,'[合计个税计算与分劈-2023年10月.xlsx]总表'!$B$3:$B$92,'[合计个税计算与分劈-2023年10月.xlsx]总表'!$F$3:$F$92,"")
```

14.基本养老保险费：

```
=XLOOKUP($B2,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$E$421:$E$479,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$K$421:$K$479,"")

```

15.基本医疗保险费：

```
=XLOOKUP(B2,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$E$421:$E$479,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$O$421:$O$479,"")
```

16.失业保险费：

```
=XLOOKUP(B2,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$E$421:$E$479,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$M$421:$M$479,"")
```

17.住房公积金：

```
=XLOOKUP(B2,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$E$421:$E$479,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$S$421:$S$479,"")
```

18.年金：

```
=XLOOKUP(B2,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$E$421:$E$479,'[2023年10月各单位五险二金收费明细表（核对版）-项目.xlsx]核对版-10月-项目'!$I$421:$I$479,"")
```

19.已计提折旧月数：

```
=IF(F7="","-",DATEDIF(EOMONTH(SUBSTITUTE(F7,".","/"),0)+1,"2023/11/1","m"))
```

20.日期转换为时间戳

```
=(待转换的日期单元格-70*365-19)*86400-8*3600
=(TODAY()-70*365-19)*86400-8*3600+17*60*60
=(NOW()-70*365-19)*86400-8*3600
=IF(((NOW()-70*365-19)*86400-8*3600)>((TODAY()-70*365-19)*86400-8*3600+17.5*60*60),TODAY(),TODAY()-1)
```

21.时间戳转换为日期格式

```
=（时间戳所在的单元格+8*3600）/86400+70*365+19
```

22.EXCEL多关键字匹配返回首个关键字，并对应显示相关内容

```
=XLOOKUP(IFERROR(INDEX($Q$5:$Q$704,MATCH(TRUE,ISNUMBER(SEARCH($Q$5:$Q$704,G6)),0)),"未匹配到关键信息"),$Q$5:$Q$704,$R$5:$R$704,"")
```

23.数值化当前所有工作表公式结果:

```
Sub FunctionTransValue_Sheets()
Dim sht As Worksheet
For Each sht In Worksheets '遍历工作表
sht.UsedRange.Value = sht.UsedRange.Value
Next
End Sub
```

```
=INDIRECT(CONCAT("'[3、2023年正式员工考勤表（泛亚）1.xlsx]2023（",A921,"月份）'!$C$",B921))
```

